// --- datasource ---
datasource db {
    provider = "sqlite"
    url      = "file:../db/database.sqlite"
}

// --- generator ---
generator client {
    provider = "prisma-client-js"
}

// --- enums/Roles.enum.prisma ---
enum Role {
    ADMIN
    CLIENT
    SUPPORT
}

// --- enums/TicketPriority.enum.prisma ---
enum TicketPriority {
    LOW
    MEDIUM
    HIGH
}

// --- enums/TicketStatus.enum.prisma ---
enum TicketStatus {
    OPEN
    IN_PROGRESS
    RESOLVED
}

// --- models/User.model.prisma ---
// models/user.prisma
model User {
    id         Int      @id @default(autoincrement())
    name       String
    username   String   @unique
    password   String
    department String
    role       Role     @default(CLIENT)
    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    ticketsCreated  Ticket[] @relation("CreatedTickets")
    ticketsAssigned Ticket[] @relation("AssignedTickets")
}

// --- models/Ticket.model.prisma ---
// models/ticket.prisma
model Ticket {
    id          Int            @id @default(autoincrement())
    title       String
    description String
    status      TicketStatus   @default(OPEN)
    priority    TicketPriority @default(MEDIUM)
    category    TicketCategory
    created_at  DateTime       @default(now())
    updated_at  DateTime       @updatedAt
    resolved_at DateTime?

    created_by_id Int
    created_by    User @relation("CreatedTickets", fields: [created_by_id], references: [id])

    assigned_to_id Int?
    assigned_to    User? @relation("AssignedTickets", fields: [assigned_to_id], references: [id])
}